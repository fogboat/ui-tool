var Rt=Object.defineProperty;var at=e=>{throw TypeError(e)};var Pt=(e,t,n)=>t in e?Rt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var I=(e,t,n)=>Pt(e,typeof t!="symbol"?t+"":t,n),J=(e,t,n)=>t.has(e)||at("Cannot "+n);var y=(e,t,n)=>(J(e,t,"read from private field"),n?n.call(e):t.get(e)),z=(e,t,n)=>t.has(e)?at("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),H=(e,t,n,o)=>(J(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n),V=(e,t,n)=>(J(e,t,"access private method"),n);var ct=(e,t,n,o)=>({set _(r){H(e,t,r,n)},get _(){return y(e,t,o)}});import{j as x}from"./jsx-runtime-D_zvdyIk.js";import{r as Tt,m as Lt,u as st,a as Nt,b as ft,c as et,e as lt,g as mt,o as Z,T as Ot,d as ht,f as ut,h as jt,i as gt,j as vt,k as yt,s as X,l as Mt,n as Et,P as Dt,p as xt,q as zt,t as G,B as bt}from"./Paper-Bare1qBP.js";import{r as h}from"./index-2yJIXLcc.js";import{r as At}from"./index-BIKhx-Qu.js";import"./index-Bn05qqr6.js";var N,S,K,O,A,$,nt;class Bt{constructor(t,n){z(this,$);z(this,N,[]);z(this,S,new Map);z(this,K,0);z(this,O,()=>{});z(this,A);I(this,"subscribe",t=>(H(this,O,()=>t({})),()=>{H(this,O,()=>{})}));I(this,"notice",(t,n,o)=>{const r="#"+ct(this,K)._++;return y(this,N).push([r,{message:t,open:!0,options:o,payload:n,onClose:()=>{this.close(r)}}]),V(this,$,nt).call(this),r});I(this,"close",t=>{if(y(this,S).has(t)){const n=y(this,S).get(t);n.open=!1,y(this,O).call(this),setTimeout(()=>{y(this,S).delete(t),y(this,N).length?V(this,$,nt).call(this):y(this,O).call(this)},y(this,A).unmountAfter)}});H(this,A,{time:3e3,maxSize:5,unmountAfter:200,...n,component:t})}get(){return y(this,S).entries()}getOptions(){return y(this,A)}}N=new WeakMap,S=new WeakMap,K=new WeakMap,O=new WeakMap,A=new WeakMap,$=new WeakSet,nt=function(){var o;const{maxSize:t,time:n}=y(this,A);if(y(this,S).size>=t&&t>0){const r=y(this,S).entries(),s=y(this,N).length;let i=0;for(;i<s;){const{value:a,done:f}=r.next();if(f)break;a[1].open&&(a[1].timer&&clearTimeout(a[1].timer),this.close(a[0])),i++}}else if(y(this,N).length){const[r,s]=y(this,N).shift();y(this,S).set(r,s),y(this,O).call(this);const i=((o=s.options)==null?void 0:o.time)??n;i>0&&(s.timer=setTimeout(()=>{this.close(r)},i))}};const Ht=e=>{const t=h.useState({})[1];return h.useLayoutEffect(()=>e.subscribe(t),[t]),[e.get(),e.getOptions()]};function $t(e){const{notifier:t}=e,[n,o]=Ht(t);return(()=>{const s=[],{component:i}=o;let a=0;for(const[f,m]of n)s.push(x.jsx(i,{index:a,message:m.message,payload:m.payload,open:m.open,onClose:m.onClose},f)),a++;return s})()}function Ut(e){var g;const{elementType:t,externalSlotProps:n,ownerState:o,skipResolvingSlotProps:r=!1,...s}=e,i=r?{}:Tt(n,o),{props:a,internalRef:f}=Lt({...s,externalSlotProps:i}),m=st(f,i==null?void 0:i.ref,(g=e.additionalProps)==null?void 0:g.ref);return Nt(t,{...a,ref:m},o)}function Ft(e={}){const{autoHideDuration:t=null,disableWindowBlurListener:n=!1,onClose:o,open:r,resumeHideDuration:s}=e,i=ft();h.useEffect(()=>{if(!r)return;function c(d){d.defaultPrevented||d.key==="Escape"&&(o==null||o(d,"escapeKeyDown"))}return document.addEventListener("keydown",c),()=>{document.removeEventListener("keydown",c)}},[r,o]);const a=et((c,d)=>{o==null||o(c,d)}),f=et(c=>{!o||c==null||i.start(c,()=>{a(null,"timeout")})});h.useEffect(()=>(r&&f(t),i.clear),[r,t,f,i]);const m=c=>{o==null||o(c,"clickaway")},E=i.clear,g=h.useCallback(()=>{t!=null&&f(s??t*.5)},[t,s,f]),T=c=>d=>{const v=c.onBlur;v==null||v(d),g()},w=c=>d=>{const v=c.onFocus;v==null||v(d),E()},l=c=>d=>{const v=c.onMouseEnter;v==null||v(d),E()},u=c=>d=>{const v=c.onMouseLeave;v==null||v(d),g()};return h.useEffect(()=>{if(!n&&r)return window.addEventListener("focus",g),window.addEventListener("blur",E),()=>{window.removeEventListener("focus",g),window.removeEventListener("blur",E)}},[n,r,g,E]),{getRootProps:(c={})=>{const d={...lt(e),...lt(c)};return{role:"presentation",...c,...d,onBlur:T(d),onFocus:w(d),onMouseEnter:l(d),onMouseLeave:u(d)}},onClickAway:m}}function dt(e){return e.substring(2).toLowerCase()}function Wt(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}function It(e){const{children:t,disableReactTree:n=!1,mouseEvent:o="onClick",onClickAway:r,touchEvent:s="onTouchEnd"}=e,i=h.useRef(!1),a=h.useRef(null),f=h.useRef(!1),m=h.useRef(!1);h.useEffect(()=>(setTimeout(()=>{f.current=!0},0),()=>{f.current=!1}),[]);const E=st(mt(t),a),g=et(l=>{const u=m.current;m.current=!1;const b=Z(a.current);if(!f.current||!a.current||"clientX"in l&&Wt(l,b))return;if(i.current){i.current=!1;return}let c;l.composedPath?c=l.composedPath().includes(a.current):c=!b.documentElement.contains(l.target)||a.current.contains(l.target),!c&&(n||!u)&&r(l)}),T=l=>u=>{m.current=!0;const b=t.props[l];b&&b(u)},w={ref:E};return s!==!1&&(w[s]=T(s)),h.useEffect(()=>{if(s!==!1){const l=dt(s),u=Z(a.current),b=()=>{i.current=!0};return u.addEventListener(l,g),u.addEventListener("touchmove",b),()=>{u.removeEventListener(l,g),u.removeEventListener("touchmove",b)}}},[g,s]),o!==!1&&(w[o]=T(o)),h.useEffect(()=>{if(o!==!1){const l=dt(o),u=Z(a.current);return u.addEventListener(l,g),()=>{u.removeEventListener(l,g)}}},[g,o]),h.cloneElement(t,w)}function ot(e){return`scale(${e}, ${e**2})`}const Gt={entering:{opacity:1,transform:ot(1)},entered:{opacity:1,transform:"none"}},tt=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),rt=h.forwardRef(function(t,n){const{addEndListener:o,appear:r=!0,children:s,easing:i,in:a,onEnter:f,onEntered:m,onEntering:E,onExit:g,onExited:T,onExiting:w,style:l,timeout:u="auto",TransitionComponent:b=Ot,...c}=t,d=ft(),v=h.useRef(),j=ht(),M=h.useRef(null),it=st(M,mt(s),n),R=p=>P=>{if(p){const k=M.current;P===void 0?p(k):p(k,P)}},U=R(E),F=R((p,P)=>{jt(p);const{duration:k,delay:D,easing:C}=ut({style:l,timeout:u,easing:i},{mode:"enter"});let L;u==="auto"?(L=j.transitions.getAutoHeightDuration(p.clientHeight),v.current=L):L=k,p.style.transition=[j.transitions.create("opacity",{duration:L,delay:D}),j.transitions.create("transform",{duration:tt?L:L*.666,delay:D,easing:C})].join(","),f&&f(p,P)}),W=R(m),_=R(w),q=R(p=>{const{duration:P,delay:k,easing:D}=ut({style:l,timeout:u,easing:i},{mode:"exit"});let C;u==="auto"?(C=j.transitions.getAutoHeightDuration(p.clientHeight),v.current=C):C=P,p.style.transition=[j.transitions.create("opacity",{duration:C,delay:k}),j.transitions.create("transform",{duration:tt?C:C*.666,delay:tt?k:k||C*.333,easing:D})].join(","),p.style.opacity=0,p.style.transform=ot(.75),g&&g(p)}),B=R(T),Q=p=>{u==="auto"&&d.start(v.current||0,p),o&&o(M.current,p)};return x.jsx(b,{appear:r,in:a,nodeRef:M,onEnter:F,onEntered:W,onEntering:U,onExit:q,onExited:B,onExiting:_,addEndListener:Q,timeout:u==="auto"?null:u,...c,children:(p,{ownerState:P,...k})=>h.cloneElement(s,{style:{opacity:0,transform:ot(.75),visibility:p==="exited"&&!a?"hidden":void 0,...Gt[p],...l,...s.props.style},ref:it,...k})})});rt&&(rt.muiSupportAuto=!0);function Kt(e){return gt("MuiSnackbarContent",e)}vt("MuiSnackbarContent",["root","message","action"]);const Xt=e=>{const{classes:t}=e;return Et({root:["root"],action:["action"],message:["message"]},Kt,t)},_t=X(Dt,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(e,t)=>t.root})(xt(({theme:e})=>{const t=e.palette.mode==="light"?.8:.98,n=zt(e.palette.background.default,t);return{...e.typography.body2,color:e.vars?e.vars.palette.SnackbarContent.color:e.palette.getContrastText(n),backgroundColor:e.vars?e.vars.palette.SnackbarContent.bg:n,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(e.vars||e).shape.borderRadius,flexGrow:1,[e.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),qt=X("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(e,t)=>t.message})({padding:"8px 0"}),Qt=X("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(e,t)=>t.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),Yt=h.forwardRef(function(t,n){const o=yt({props:t,name:"MuiSnackbarContent"}),{action:r,className:s,message:i,role:a="alert",...f}=o,m=o,E=Xt(m);return x.jsxs(_t,{role:a,square:!0,elevation:6,className:Mt(E.root,s),ownerState:m,ref:n,...f,children:[x.jsx(qt,{className:E.message,ownerState:m,children:i}),r?x.jsx(Qt,{className:E.action,ownerState:m,children:r}):null]})});function Jt(e){return gt("MuiSnackbar",e)}vt("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const Vt=e=>{const{classes:t,anchorOrigin:n}=e,o={root:["root",`anchorOrigin${G(n.vertical)}${G(n.horizontal)}`]};return Et(o,Jt,t)},pt=X("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`anchorOrigin${G(n.anchorOrigin.vertical)}${G(n.anchorOrigin.horizontal)}`]]}})(xt(({theme:e})=>({zIndex:(e.vars||e).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",variants:[{props:({ownerState:t})=>t.anchorOrigin.vertical==="top",style:{top:8,[e.breakpoints.up("sm")]:{top:24}}},{props:({ownerState:t})=>t.anchorOrigin.vertical!=="top",style:{bottom:8,[e.breakpoints.up("sm")]:{bottom:24}}},{props:({ownerState:t})=>t.anchorOrigin.horizontal==="left",style:{justifyContent:"flex-start",[e.breakpoints.up("sm")]:{left:24,right:"auto"}}},{props:({ownerState:t})=>t.anchorOrigin.horizontal==="right",style:{justifyContent:"flex-end",[e.breakpoints.up("sm")]:{right:24,left:"auto"}}},{props:({ownerState:t})=>t.anchorOrigin.horizontal==="center",style:{[e.breakpoints.up("sm")]:{left:"50%",right:"auto",transform:"translateX(-50%)"}}}]}))),Zt=h.forwardRef(function(t,n){const o=yt({props:t,name:"MuiSnackbar"}),r=ht(),s={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{action:i,anchorOrigin:{vertical:a,horizontal:f}={vertical:"bottom",horizontal:"left"},autoHideDuration:m=null,children:E,className:g,ClickAwayListenerProps:T,ContentProps:w,disableWindowBlurListener:l=!1,message:u,onBlur:b,onClose:c,onFocus:d,onMouseEnter:v,onMouseLeave:j,open:M,resumeHideDuration:it,TransitionComponent:R=rt,transitionDuration:U=s,TransitionProps:{onEnter:F,onExited:W,..._}={},...q}=o,B={...o,anchorOrigin:{vertical:a,horizontal:f},autoHideDuration:m,disableWindowBlurListener:l,TransitionComponent:R,transitionDuration:U},Q=Vt(B),{getRootProps:p,onClickAway:P}=Ft({...B}),[k,D]=h.useState(!0),C=Ut({elementType:pt,getSlotProps:p,externalForwardedProps:q,ownerState:B,additionalProps:{ref:n},className:[Q.root,g]}),L=Y=>{D(!0),W&&W(Y)},St=(Y,wt)=>{D(!1),F&&F(Y,wt)};return!M&&k?null:x.jsx(It,{onClickAway:P,...T,children:x.jsx(pt,{...C,children:x.jsx(R,{appear:!0,in:M,timeout:U,direction:a==="top"?"down":"up",onEnter:St,onExited:L,..._,children:E||x.jsx(Yt,{message:u,action:i,...w})})})})});function te({open:e,message:t,payload:n,onClose:o}){return x.jsx(Zt,{sx:{position:"static",mb:"8px"},open:e,message:`${t}${n==null?void 0:n.icon}`,action:x.jsx(bt,{color:"secondary",size:"small",onClick:o,children:"UNDO"})})}const kt=new Bt(te);function ee(e){kt.notice(e,{icon:"👌"})}let ne=0;function Ct(){return x.jsxs("div",{children:[At.createPortal(x.jsx("div",{style:{position:"fixed",right:16,top:16},children:x.jsx($t,{notifier:kt})}),document.body),x.jsx(bt,{onClick:()=>{ee("新消息"+ne++)},children:"通知"})]})}Ct.__docgenInfo={description:"",methods:[],displayName:"Demo"};const oe=`import { NoticeProps, Notifications, Notifier } from "@fogboat/ui-tool";
import Button from "@mui/material/Button";

import Snackbar from '@mui/material/Snackbar';
import { createPortal } from "react-dom";

interface NoticePayload {
    /**
    * 自定义内容
    */
    icon?: string;

}
// 自定义组件实现NoticeProps
interface NoticeCompProps extends NoticeProps<NoticePayload> { }
function NoticeComponent({ open, message, payload, onClose }: NoticeCompProps) {
    return <Snackbar sx={{ position: "static", mb: "8px" }} open={open} message={\`\${message}\${payload?.icon}\`} action={<Button color="secondary" size="small" onClick={onClose}>UNDO</Button>} />
}

// 实例化通知器
const notifier = new Notifier(NoticeComponent)
// 封装里一个通知函数 可在任意位置调用
function notice(msg: string) {
    notifier.notice(msg, { icon: "👌" })
}

let id = 0
export default function Demo() {
    return (
        <div >
            {createPortal(<div style={{ position: "fixed", right: 16, top: 16 }}>
                {/* 消息组件出现的位置 */}
                <Notifications notifier={notifier} />
            </div>, document.body)}

            <Button onClick={() => { notice("新消息" + id++); }}>通知</Button>
        </div>
    )

}



`,ue={title:"消息通知",component:Ct,parameters:{layout:"centered",docs:{source:{code:oe}}}},de={name:"例子",args:{}};export{de as Primary,ue as default};
